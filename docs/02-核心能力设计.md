# 🔧 精灵1号 - 核心能力设计

> 眼睛 + 手 + 大脑 + 自学能力 = 无限可能

---

## 一、能力架构总览

```
┌─────────────────────────────────────────────────────────────┐
│                      🧚 精灵1号                              │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐         │
│  │   👁️ 眼睛   │  │   🖐️ 手    │  │   🧠 大脑   │         │
│  │  看任何页面  │  │ 操作任何页面 │  │ 理解和决策  │         │
│  └─────────────┘  └─────────────┘  └─────────────┘         │
│                                                             │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐         │
│  │   📚 自学   │  │   🔑 授权   │  │   🔐 安全   │         │
│  │ 不会就学习  │  │ 用户给钥匙  │  │ 确认才执行  │         │
│  └─────────────┘  └─────────────┘  └─────────────┘         │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

---

## 二、眼睛：看任何页面/终端

### 能力说明

精灵1号能"看到"：
- 🌐 任何网页的内容和结构
- 🖥️ 服务器的状态和日志
- 📱 App 的界面（通过截图）
- 📄 文件和文档

### 技术实现

```
浏览器页面：
├─ 截图 → AI 分析图像
├─ DOM 结构 → AI 理解页面元素
└─ 文本内容 → AI 提取信息

服务器：
├─ 执行命令 → 获取输出
├─ 读取日志 → AI 分析
└─ 查看状态 → AI 诊断

文件：
├─ 读取内容
├─ AI 理解
└─ 提取关键信息
```

### Moltbot 已有能力

```javascript
// 浏览器截图
await browser.screenshot()

// 获取页面内容
await browser.content()

// 执行 Shell 命令
await shell.exec('cat /var/log/nginx/error.log')
```

---

## 三、手：操作任何页面/终端

### 能力说明

精灵1号能"操作"：
- 🖱️ 点击任何按钮/链接
- ⌨️ 输入任何文本
- 📋 复制/粘贴内容
- 🖥️ 执行任何命令
- 📤 上传/下载文件

### 技术实现

```
浏览器操作：
├─ browser.goto(url)      # 打开网页
├─ browser.click(sel)     # 点击
├─ browser.fill(sel, txt) # 输入
├─ browser.select(sel, v) # 选择下拉
└─ browser.upload(file)   # 上传文件

服务器操作：
├─ shell.exec(cmd)        # 执行命令
├─ file.read(path)        # 读取文件
├─ file.write(path, txt)  # 写入文件
└─ ssh.connect(host)      # SSH 连接
```

### Moltbot 已有能力

```javascript
// 浏览器控制
await browser.goto('https://example.com')
await browser.click('#submit-btn')
await browser.fill('#username', 'user123')

// Shell 执行
await shell.exec('systemctl restart nginx')
```

---

## 四、大脑：理解和决策

### 能力说明

精灵1号能"思考"：
- 🎯 理解用户的自然语言指令
- 📋 自动分解复杂任务
- 🤔 决定执行什么操作
- 📊 分析执行结果
- 💡 遇到问题自己想办法

### 技术实现

```
用户指令 → AI 理解
    │
    ▼
任务分解 → AI 规划步骤
    │
    ▼
执行决策 → AI 决定调用什么工具
    │
    ▼
结果分析 → AI 判断是否成功
    │
    ▼
异常处理 → AI 决定如何处理问题
```

### 支持任意大模型

精灵1号不绑定特定模型，支持：

| 模型 | 说明 |
|------|------|
| OpenAI GPT-4/4o | 通用能力强 |
| Claude 3.5 | 长文本、代码 |
| Gemini | Google 生态 |
| DeepSeek | 推理、代码 |
| Qwen | 中文优化 |
| Ollama 本地模型 | 隐私、离线 |
| 任何兼容 API | 无限扩展 |

**用户配置哪个模型，精灵就用哪个！**

---

## 五、自学：不会就学习

### 能力说明

精灵1号遇到不会的东西：
1. 全网搜索教程和文档
2. 学习理解
3. 记住（下次就会了）
4. 执行

### 示例

```
用户: "帮我用剪映 API 剪个视频"

精灵1号:
├─ 我没用过剪映 API
├─ 搜索 "剪映 API 文档 使用教程"
├─ 学习：原来要这样调用...
├─ 用用户给的 API Key 去调用
└─ 完成！（下次就会了）
```

### 技术实现

```javascript
async function learnAndExecute(task) {
  // 1. 检查是否已学过
  const knowledge = await memory.get(task);
  if (knowledge) {
    return await execute(knowledge);
  }
  
  // 2. 搜索学习
  const searchResults = await webSearch(`${task} API 教程 文档`);
  
  // 3. AI 学习理解
  const learned = await AI.analyze(searchResults);
  
  // 4. 记住
  await memory.save(task, learned);
  
  // 5. 执行
  return await execute(learned);
}
```

---

## 六、授权：用户给钥匙

### 能力说明

精灵1号的能力 = 用户给的授权

用户提供：
- 🔑 API Key（各种服务）
- 🍪 登录态 Cookie
- 🔐 SSH 密钥
- 📱 OAuth 授权

精灵拿着这些"钥匙"去工作。

### 授权管理

```
┌─────────────────────────────────────────────────┐
│  授权管理（Web 控制台）                           │
├─────────────────────────────────────────────────┤
│                                                 │
│  已授权的服务：                                   │
│                                                 │
│  🔑 AI 模型                                     │
│     ├─ OpenAI: sk-xxx...xxx  ✅                 │
│     └─ Claude: sk-xxx...xxx  ✅                 │
│                                                 │
│  🌐 网站登录                                     │
│     ├─ 12306: 已登录 ✅                         │
│     ├─ 小红书: 已登录 ✅                         │
│     └─ [+ 添加新网站]                           │
│                                                 │
│  🖥️ 服务器                                      │
│     ├─ 生产服务器: SSH 已配置 ✅                 │
│     └─ [+ 添加服务器]                           │
│                                                 │
└─────────────────────────────────────────────────┘
```

### 安全存储

```
用户凭证 → 加密存储 → 隔离的环境变量

- 每个用户的凭证独立隔离
- 加密存储，精灵只在执行时解密使用
- 用户可随时撤销授权
```

---

## 七、安全：确认才执行

### 安全分级

| 级别 | 操作类型 | 确认方式 |
|------|---------|---------|
| 🟢 低 | 浏览、查询、读取 | 无需确认 |
| 🟡 中 | 发送消息、调用 API | 飞书通知 |
| 🟠 高 | 登录、修改文件、执行命令 | 飞书确认 |
| 🔴 极高 | 删除、支付、修改配置 | 飞书 + 指纹确认 |

### 确认流程

```
精灵1号要执行敏感操作
        │
        ▼
   ┌──────────────────────────────────────┐
   │  📱 飞书推送                          │
   │                                      │
   │  🔐 精灵1号请求确认                   │
   │                                      │
   │  操作：重启 Nginx 服务                │
   │  服务器：production-server           │
   │                                      │
   │  [✅ 确认] [❌ 拒绝] [🛑 终止所有]    │
   │                                      │
   └──────────────────────────────────────┘
        │
        ▼
   用户确认 → 精灵执行
   用户拒绝 → 取消操作
   终止所有 → 精灵暂停所有工作
```

### 一键终止

用户随时可以发送：
- `/stop` 或 `/终止` → 立即停止所有操作
- `/resume` 或 `/恢复` → 恢复工作
- `/status` 或 `/状态` → 查看精灵状态

---

## 八、能力扩展

### Agent 创建

精灵1号可以根据需求动态创建 Agent：

```
用户: "帮我分析竞品，写份报告"

精灵1号:
├─ 分析：需要 "研究员" + "写手"
├─ 创建 Agent A: 研究员
│   ├─ 能力：搜索、阅读、分析
│   └─ 工具：web_search, browser
├─ 创建 Agent B: 写手
│   ├─ 能力：写作、排版
│   └─ 工具：write_file
├─ Agent A 执行研究
├─ Agent B 根据研究写报告
└─ 汇报完成
```

### Skills 扩展

用户或开发者可以为精灵添加新技能：

```typescript
// 自定义 Skill 示例
const mySkill = {
  name: "查快递",
  description: "查询快递物流信息",
  
  async execute(trackingNumber: string) {
    // 实现逻辑
  }
};

// 注册到精灵
spirit.registerSkill(mySkill);
```

---

*下一篇：[03-技术架构](./03-技术架构.md)*
