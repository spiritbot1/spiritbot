# 📱 精灵1号 - 产品形态

> 飞书入口 + Web 管理 + 云端服务

---

## 一、产品形态决策

### 选型对比

| 形态 | 用户安装 | 开发成本 | 体验 | 结论 |
|------|---------|---------|------|------|
| 飞书机器人 | 不需要 | 低 | 够用 | ✅ **MVP 首选** |
| Web 控制台 | 不需要 | 中 | 好 | ✅ **配合使用** |
| 桌面软件 | 需要 | 高 | 很好 | ⏳ 后期 |
| 手机 App | 需要 | 很高 | 很好 | ❌ 不推荐 |

### 最终方案

```
精灵1号 = 飞书机器人（主交互）+ Web 控制台（管理配置）+ 云端服务（执行）
```

**用户不需要安装任何东西！**

---

## 二、用户使用流程

### 首次使用

```
1. 在飞书中添加"精灵1号"机器人
   └─ 搜索 → 添加 → 完成

2. 打开 Web 控制台，配置授权
   └─ spirit.xxx.com → 登录 → 配置 API Key、登录网站等

3. 在飞书中开始使用
   └─ 直接发消息给精灵1号
```

### 日常使用

```
用户在飞书中：

用户: "精灵，帮我查一下服务器状态"
精灵: "好的，正在查看..."
精灵: [状态报告卡片]

用户: "精灵，帮我在小红书发个帖子"
精灵: "好的，需要你先登录小红书"
精灵: [登录引导卡片]
```

---

## 三、飞书机器人设计

### 消息交互

```
┌─────────────────────────────────────────────────┐
│  飞书 - 精灵1号                                  │
├─────────────────────────────────────────────────┤
│                                                 │
│  👤 你: 帮我检查一下生产服务器                   │
│                                                 │
│  🧚 精灵1号:                                    │
│  收到！正在检查生产服务器...                     │
│                                                 │
│  ┌─────────────────────────────────────────┐   │
│  │  📊 服务器状态报告                        │   │
│  │                                         │   │
│  │  🖥️ production-server                   │   │
│  │  ├─ CPU: 45% ✅                         │   │
│  │  ├─ 内存: 72% ⚠️                        │   │
│  │  ├─ 磁盘: 65% ✅                        │   │
│  │  └─ 运行时间: 15天                       │   │
│  │                                         │   │
│  │  ⚠️ 发现 1 个问题：                      │   │
│  │  内存使用较高，建议重启 Node 进程         │   │
│  │                                         │   │
│  │  [✅ 重启进程] [📋 查看详情] [❌ 忽略]    │   │
│  └─────────────────────────────────────────┘   │
│                                                 │
└─────────────────────────────────────────────────┘
```

### 卡片类型

| 卡片类型 | 用途 |
|---------|------|
| 状态报告卡片 | 展示服务器/任务状态 |
| 确认操作卡片 | 敏感操作需用户确认 |
| 登录引导卡片 | 引导用户登录网站 |
| 进度汇报卡片 | 展示任务执行进度 |
| 结果展示卡片 | 展示任务完成结果 |

### 控制指令

| 指令 | 功能 |
|------|------|
| `/stop` 或 `/终止` | 立即终止所有操作 |
| `/resume` 或 `/恢复` | 恢复精灵工作 |
| `/status` 或 `/状态` | 查看精灵状态 |
| `/help` 或 `/帮助` | 查看帮助 |

---

## 四、Web 控制台设计

### 功能模块

```
┌─────────────────────────────────────────────────────────────┐
│  精灵1号控制台                          [用户名] [退出]      │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  📊 仪表盘   🔑 授权管理   🤖 Agent   📝 任务历史   ⚙️ 设置  │
│                                                             │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │  📊 今日概览                                         │   │
│  │                                                     │   │
│  │  执行任务: 15 个     成功率: 93%     节省时间: 2.5h  │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │  🔑 已授权服务                                       │   │
│  │                                                     │   │
│  │  ✅ OpenAI API          已配置                      │   │
│  │  ✅ 12306               已登录                      │   │
│  │  ✅ 小红书              已登录                      │   │
│  │  ⚠️ 生产服务器 SSH      即将过期                    │   │
│  │                                                     │   │
│  │  [+ 添加新授权]                                      │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 授权管理页面

```
┌─────────────────────────────────────────────────────────────┐
│  🔑 授权管理                                                │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  AI 模型                                                    │
│  ┌─────────────────────────────────────────────────────┐   │
│  │  OpenAI                                             │   │
│  │  API Key: sk-xxxx...xxxx                           │   │
│  │  状态: ✅ 有效     余额: $45.23                     │   │
│  │  [测试连接] [更新] [删除]                           │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  网站登录                                                   │
│  ┌─────────────────────────────────────────────────────┐   │
│  │  12306.cn                                           │   │
│  │  状态: ✅ 已登录    有效期: 还剩 5 天               │   │
│  │  [重新登录] [删除]                                  │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │  + 添加网站登录                                     │   │
│  │                                                     │   │
│  │  网站地址: [________________________]               │   │
│  │                                                     │   │
│  │  [打开浏览器登录]                                   │   │
│  │                                                     │   │
│  │  说明：点击后会打开浏览器，请完成登录，             │   │
│  │  精灵会自动保存登录状态。                           │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

---

## 五、交互流程示例

### 示例1：添加网站授权

```
1. 用户在 Web 控制台点击"添加网站登录"
2. 输入网站地址：12306.cn
3. 点击"打开浏览器登录"
4. 精灵打开浏览器，显示 12306 登录页
5. 用户完成登录（输入账号密码、验证码）
6. 精灵检测到登录成功，保存 Cookie
7. 显示"授权成功！"
```

### 示例2：执行任务需要确认

```
用户: "精灵，帮我把 error.log 清空"

精灵在飞书发送确认卡片：
┌─────────────────────────────────────┐
│  🔐 敏感操作确认                    │
│                                     │
│  操作：清空文件                     │
│  文件：/var/log/error.log           │
│  风险等级：🟠 高                    │
│                                     │
│  确认执行此操作？                   │
│                                     │
│  [✅ 确认] [❌ 拒绝]                │
└─────────────────────────────────────┘

用户点击"确认" → 精灵执行 → 汇报结果
```

### 示例3：复杂任务执行

```
用户: "精灵，帮我在小红书发布 3 条旅游攻略"

精灵：
┌─────────────────────────────────────┐
│  📋 任务分解                        │
│                                     │
│  1. ⏳ 生成 3 条攻略内容            │
│  2. ⬜ 准备配图                     │
│  3. ⬜ 发布到小红书                 │
│                                     │
│  预计耗时：10 分钟                  │
│  开始执行...                        │
└─────────────────────────────────────┘

执行过程中持续更新进度...

完成后：
┌─────────────────────────────────────┐
│  ✅ 任务完成                        │
│                                     │
│  已发布 3 条攻略：                  │
│  1. 杭州3天2晚攻略 [查看]           │
│  2. 西湖必打卡景点 [查看]           │
│  3. 杭州美食推荐 [查看]             │
│                                     │
│  总浏览量：-- (24h后更新)           │
└─────────────────────────────────────┘
```

---

## 六、技术实现

### 飞书机器人

- 使用飞书开放平台创建应用
- 配置消息回调地址
- 配置卡片交互回调

### Web 控制台

- 前端：React / Vue
- 后端：与精灵1号服务共用
- 认证：飞书 OAuth 登录

### 云端服务

- 部署在云服务器
- 运行 Moltbot + 精灵插件
- 24/7 运行

---

*下一篇：[05-开发路线图](./05-开发路线图.md)*
